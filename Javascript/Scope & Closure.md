# Scope & Closure

스코프 == 유효범위

var은 함수 스코프를 따르며,  let과 const는 블록 스코프를 따르는데, 자신이 선언된 곳과 가장 가까운 블록을 유효 범위로 가진다.

변수 이름, 함수 이름, 클래스 이름 같은 식별자가 본인이 선언된 위치에 따라서 다른 코드에서 자신이 참조될수 있을 지 없을지 결정되는 것

자바스크립트에선 스코프는 2가지 타입이 있습니다. - **전역, 지역**

전역 스코프 - 최상단 , 말 그대로 전역에 선언되어 있어 어는 곳에서 든지 해당 변수에 접근할 수 있다는 의미.

지역 스코프 - 해당 지역에서만 접근할 수 있어 지역을 벗어난 곳에서는 접근할 수 없다는 것을 의미.

## 스코프 체인

자바스크립트 엔진은 식별자를 찾을 때 먼저 자신이 속한 스코프 범위에서 찾고 자신이 범위에도 없을 경우 상위 스코프에서 다시 찾아 나간다. 이 현상을 스코프 체인 이라고 하며 스코프가 중첩되어있는 모든 상황에서 발생한다.

정리 : 변수를 참조할 때 스코프체인을 통하여 변수를 참조함. 자신의 유효범위안에서 변수를 참조하지 못하면 상단으로 계속 쭉쭉 전역까지 찾는다 없을 경우 에러 발생 

## 렉시컬 스코프

자바스크립트는 렉시컬 스코프를 따르기 때문에 함수가 정의되는 시점에 결정된다. (정적 스코프)

```jsx
function outer(){
    var x = 1;

    function inner(){
        console.log(x);
    }

    inner();
}

outer(); // 1
```

 1. 함수 호출 ⇒ 실행컨텍스트 생성 ⇒ 렉시컬 환경 생성 (포함하는 식별자, 식별자에 바인딩 된 값, 상위 렉시켤 환경에 대한 참조) 자료구조 ⇒ 스택에서 pop하여 제거  

[https://poiemaweb.com/js-scope](https://poiemaweb.com/js-scope)

---

## 클로저

클로저(closure)는 내부함수와 밀접한 관계를 가지고 있는 주제다. 내부함수는 외부함수의 지역변수에 접근 할 수 있는데 외부함수의 실행이 끝나서 외부함수가 소멸된 이후에도 내부함수가 외부함수의 변수에 접근 할 수 있다. 이러한 메커니즘을 클로저라고 한다.

중첩함수에서상위 스코프의 식별자를 참조하고 있고 본인의 외부 함수보다 더 오래 살아있다면  클로저이다.

```
- 자신을 내포하는 함수의 컨텍스트에 접근할 수 있는 함수
- 함수가 특정 스코프에 접근할 수 있도록 의도적으로 그 스코프에서 정의하는 것
- 함수를 선언할 때 만들어지는 유효범위가 사라진 후에도 호출할 수 있는 함수
- 이미 생명 주기상 끝난 외부 함수의 변수를 참조하는 함수
- 자유 변수가 있는 함수와 자유 변수를 알 수 있는 환경의 결합
- 로컬 변수를 참조하고 있는 함수 내의 함수
- 자신이 생성될 때의 스코프에서 알 수 있었던 변수들 중 언젠가 자신이 실행될 때 사용할 변수들만을 기억하여 유지하는 함수
```

```jsx
function outter(){
    var title = 'coding everybody';  
    return function(){        
        alert(title);
    }
}
inner = outter();
inner();
```