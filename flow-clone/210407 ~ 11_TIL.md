# 210407 ~ 11_TIL

### 7ì¼

1. modal ì‘ì—…,
2. login api í˜¸ì¶œ í›„ í† í° ë°›ì•„ì˜¤ê¸° 

### 8ì¼ , 9ì¼

.... ë¡œê·¸ì¸ ì‚½ì§ˆ 

> ë¡œê·¸ì¸ ì‚½ì§ˆí•˜ë©´ì„œ

**ìš”ì²­ í—¤ë”** 

**Authorization**Â : ì¸ì¦ í† í°ì„ ì„œë²„ë¡œ ë³´ë‚¼ ë•Œ ì“°ì´ëŠ” í—¤ë”

**Cookie**Â : ì¿ ê¸° ê°’ key-valueë¡œ í‘œí˜„ëœë‹¤. ex) attr1=value1; attr2=value2

[https://jeong-pro.tistory.com/181](https://jeong-pro.tistory.com/181)

### ì„œë²„ ê¸°ë°˜ ì¸ì¦, í† í° ê¸°ë°˜ ì¸ì¦ (Session, Cookie / JSON Web Token)

[https://mangkyu.tistory.com/55](https://mangkyu.tistory.com/55)

[https://dooopark.tistory.com/6](https://dooopark.tistory.com/6)

### í† í°

[https://velopert.com/2350](https://velopert.com/2350)

**1. í† í°ì€ ì™œ ì‚¬ìš©í• ê¹Œ?**

ìš°ì„ , ê°€ì¥ í° ì´ìœ ëŠ” **HTTPì˜ íŠ¹ì„±ë•Œë¬¸**ì…ë‹ˆë‹¤. HTTPëŠ” **ì—°ê²° ì§€í–¥ í”„ë¡œí† ì½œ**ì¸ **TCP** ê¸°ë°˜ì„ì—ë„ ë¶ˆêµ¬í•˜ê³ , **ëŒ€í‘œì ì¸ ë¹„ì—°ê²° ì§€í–¥ í”„ë¡œí† ì½œ**ì…ë‹ˆë‹¤. ë”°ë¼ì„œ í•œ ë²ˆì˜ ìš”ì²­-ì‘ë‹µ ì‚¬ì´í´ì´ ì™„ë£Œë˜ë©´ ì—°ê²°ì„ ì¢…ë£Œí•˜ê¸° ë•Œë¬¸ì—, ë™ì¼í•œ í´ë¼ì´ì–¸íŠ¸ê°€ ìš”ì²­ì„ ì•„ë¬´ë¦¬ ë§ì´ í•˜ë”ë¼ë„ í”„ë¡œí† ì½œì€ ëª¨ë‘ **ì²˜ìŒë³´ëŠ” ê²ƒ ë§ˆëƒ¥ ì¸ì§€**í•©ë‹ˆë‹¤! ì´ë¥¼ stateless í•˜ë‹¤ê³  í‘œí˜„í•˜ê¸°ë„ í•©ë‹ˆë‹¤.

**stateful**í•´ì§€ê¸° ìœ„í•´ì„œ, ì¦‰, ìƒíƒœë¥¼ ìœ ì§€í•˜ê¸° ìœ„í•´ ë§ì€ ì‹œë„ë“¤ì´ ìˆì—ˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ë©´, ìš°ë¦¬ê°€ ì˜ ì•„ëŠ” **ì„¸ì…˜**ì´ë‚˜ **ì¿ í‚¤**ê°€ ìˆìŠµë‹ˆë‹¤. ì´ëŠ” **ëŒ€í‘œì ì¸ ì„œë²„ ê¸°ë°˜ ì¸ì¦ ì‹œìŠ¤í…œ**ì…ë‹ˆë‹¤. ì´ ì‹œìŠ¤í…œì€ ì¸ì¦ì— í•„ìš”í•œ íŠ¹ì • ìœ ì € ì •ë³´ë¥¼ ì„œë²„ í˜¹ì€ ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥í•  ìˆ˜ë°–ì— ì—†ìŠµë‹ˆë‹¤. ë”°ë¼ì„œ, ì„œë²„ë‚˜ ë°ì´í„°ë² ì´ìŠ¤ì˜ ë¶€ë‹´ì´ ì¦ê°€í•˜ê² ì£ ? ğŸ˜¥ ë˜í•œ, CORS (Cross-Origin Resource Sharing)ì˜ ë¬¸ì œë„ ì¡´ì¬í•©ë‹ˆë‹¤. ì›¹ ì–´í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ì„¸ì…˜ì„ ê´€ë¦¬ í•  ë•Œ ìì£¼ ì‚¬ìš©ë˜ëŠ” ì¿ í‚¤ëŠ” ë‹¨ì¼ ë„ë©”ì¸ ë° ì„œë¸Œ ë„ë©”ì¸ì—ì„œë§Œ ì‘ë™í•˜ë„ë¡ ì„¤ê³„ë˜ì–´ìˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ ì¿ í‚¤ë¥¼ ì—¬ëŸ¬ ë„ë©”ì¸ì—ì„œ ê´€ë¦¬í•˜ëŠ”ê²ƒì€ ì¢€ ë²ˆê±°ë¡­ìŠµë‹ˆë‹¤.

ê·¸ëŸ¬ë‚˜ í† í° ê¸°ë°˜ ì¸ì¦ ì‹œìŠ¤í…œì€ **stateless** í•©ë‹ˆë‹¤. **ë¬´ìƒíƒœ**. ì¦‰ **ìƒíƒœìœ ì§€ë¥¼ í•˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” ê²ƒì´ì£ **. ì´ ì‹œìŠ¤í…œì—ì„œëŠ” ë” ì´ìƒ ìœ ì €ì˜ ì¸ì¦ ì •ë³´ë¥¼ ì„œë²„ë‚˜ ì„¸ì…˜ì— ë‹´ì•„ë‘ì§€ ì•ŠìŠµë‹ˆë‹¤. ì„œë²„ì˜ ë¶€ë‹´ì´ ê°ì†Œí• ë¿ë§Œ ì•„ë‹ˆë¼ ë³´ì•ˆì„±ë„ ë†’ê³ , ì—¬ëŸ¬ í”Œë«í¼ ë° ë„ë©”ì¸ì—ì„œ ì ìš©ê°€ëŠ¥í•˜ë‹¤ëŠ” ì¥ì ì´ ìˆìŠµë‹ˆë‹¤! ë˜í•œ, ëŒ€í‘œì ì¸ í† í° ê¸°ë°˜ ì¸ì¦ ì‹œìŠ¤í…œì¸ JWTëŠ” ì›¹ í‘œì¤€ìœ¼ë¡œì„œ, ë§ì´ ì´ìš©ë˜ê³  ìˆìŠµë‹ˆë‹¤.

**2. í† í°ì€ ì–´ë””ì— ë‹´ì•„ì•¼í• ê¹Œ?**

ìš°ë¦¬ëŠ” **í† í°ì´ ìœ ì € ì¸ì¦ì„ ìœ„í•´ ì•„ì£¼ íš¨ê³¼ì ì¸ ë„êµ¬**ë¼ëŠ” ê²ƒì„ ì•Œì•˜ìŠµë‹ˆë‹¤.Â **ìœ ì €ë¥¼ ì¸ì¦í•  ìˆ˜ ìˆëŠ” ì–´ë–¤ ê°’**ì„ í† í°ğŸ“¦ì— ë‹´ê² ìŠµë‹ˆë‹¤. ê·¸ë ‡ë‹¤ë©´! í† í°ì€ HTTPì˜ ì–´ë””ì— ë‹´ì•„ì„œ ì „ë‹¬í•´ì•¼ í• ê¹Œìš”?Â **ì¸ì¦ ì •ë³´**ëŠ” í‘œì¤€ì ìœ¼ë¡œÂ `Authorization header`ì— ë‹´ìŠµë‹ˆë‹¤. ê·¸ í˜•íƒœë¥¼ ìì„¸íˆ ì‚´í´ë³´ìë©´, ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

![210407%20~%2011_TIL%205f2ae51bea1844629073b0885fee9494/Untitled.png](210407%20~%2011_TIL%205f2ae51bea1844629073b0885fee9494/Untitled.png)

`header`Â ë‚´ì—Â `Authorization`Â Keyì˜ Value ê°’ìœ¼ë¡œì„œ ìš°ë¦¬ëŠ”Â **ì¸ì¦ ìŠ¤í‚¤ë§ˆ**ë¥¼ ë‹´ìŠµë‹ˆë‹¤. ì´ë•Œ, ì¸ì¦ ìŠ¤í‚¤ë§ˆëŠ”Â `type`Â `credential`ë¡œ ì´ë£¨ì–´ì§€ëŠ”ë°ìš”.Â `type`ì€ ì¸ì¦ ë°©ì‹ì„ ì˜ë¯¸í•˜ë©°, ëŒ€í‘œì ìœ¼ë¡œÂ `Bearer`ì´ ìˆìŠµë‹ˆë‹¤.Â `credential`ì€ ì¸ì¦ì •ë³´, ì¦‰, ì‹¤ì§ˆì ìœ¼ë¡œ ìš°ë¦¬ê°€ ë³´ë‚´ê³ ì í•˜ëŠ” ìœ ì €ì˜ ì¸ì¦ì •ë³´ì…ë‹ˆë‹¤. ëŒ€í‘œì ìœ¼ë¡œÂ `access token`(ìœ„ ê·¸ë¦¼ì˜ '2B-LtDr4UURb87K' ë¶€ë¶„)ì˜ ê°’ì´ ìˆê² ë„¤ìš”!

`type`ì˜ ë” ë§ì€ ì¢…ë¥˜ê°€ ê¶ê¸ˆí–ˆëŠ”ë°, POSTMANì„ ì°¸ê³ í–ˆì„ë•Œ, ë‹¤ìŒê³¼ ê°™ì€Â `type`ì´ ìˆëŠ” ê²ƒ ê°™ìŠµë‹ˆë‹¤.

# 3. ê²°ë¡ 

ì´ë²ˆì—ëŠ” í† í° ì¸ì¦ ë°©ì‹ì´ ì™œ í•„ìš”í•œì§€, ì–´ë–»ê²Œ í† í°ì„ í†µí•´ ì¸ì¦ ì •ë³´ë¥¼ ë‹´ëŠ”ì§€ ì‚´í´ë³´ì•˜ìŠµë‹ˆë‹¤! ë¬´ì‘ì •Â `token header`ë¥¼ ë§Œë“¤ì–´ì„œ ë³´ë‚´ê³¤ í–ˆëŠ”ë°, ì´ë²ˆ ê¸°íšŒì—Â **í‘œì¤€**ì„ ì˜ì§€í‚¤ë©° ê°œë°œí•  ìˆ˜ ìˆê² ìŠµë‹ˆë‹¤!

# ì°¸ê³  ìë£Œ

- [https://velopert.com/2350](https://velopert.com/2350)
- [https://velog.io/@city7310/%EB%B0%B1%EC%97%94%EB%93%9C%EA%B0%80-%EC%9D%B4%EC%A0%95%EB%8F%84%EB%8A%94-%ED%95%B4%EC%A4%98%EC%95%BC-%ED%95%A8-5.-%EC%82%AC%EC%9A%A9%EC%9E%90-%EC%9D%B8%EC%A6%9D-%EB%B0%A9%EC%8B%9D-%EA%B2%B0%EC%A0%95](https://velog.io/@city7310/%EB%B0%B1%EC%97%94%EB%93%9C%EA%B0%80-%EC%9D%B4%EC%A0%95%EB%8F%84%EB%8A%94-%ED%95%B4%EC%A4%98%EC%95%BC-%ED%95%A8-5.-%EC%82%AC%EC%9A%A9%EC%9E%90-%EC%9D%B8%EC%A6%9D-%EB%B0%A9%EC%8B%9D-%EA%B2%B0%EC%A0%95)

---

### 10ì¼

1. ì¿ í‚¤ ì—†ì„ ì‹œ ë¡œê·¸ì¸ í˜ì´ì§€ ë¦¬ë‹¤ì´ë ‰íŠ¸ 

```jsx
function loginAPI(data) {
  return axios.post('/login', qs.stringify(data));
}

function* login(action) {
  try {
    const result = yield call(loginAPI, action.data);
    const { token } = result.data;
    yield put({
      type: LOGIN_SUCCESS,
      data: token,
    });
    axios.defaults.headers.common.Authorization = `Bearer ${token}`;
    document.cookie = `token=${token}`;
    document.cookie = `userId=${action.data.username}`;
  } catch (error) {
    console.log(error);
    yield put({
      type: LOGIN_FAILURE,
      error: error.response.data,
    });
  }
}
/*
ë¡œê·¸ì¸ apië¥¼ í˜¸ì¶œ í›„ ë°˜í™˜ê°’ìœ¼ë¡œ í† í°ì„ ë°›ëŠ”ë‹¤ (ë¡œê·¸ì¸ ìœ ì§€ë¥¼ í•˜ê³  íŒë³„í•˜ê¸° ìœ„í•´ í† í°ì„ ì¿ í‚¤ì— ì €ì¥í–ˆë‹¤.)

í† í° ê¸°ë°˜ì˜ ì¸ì¦ ì‹œìŠ¤í…œì€ ì•„ë˜ì™€ ê°™ì€ ê³¼ì •ìœ¼ë¡œ ì‘ë™í•œë‹¤.
1. ì‚¬ìš©ìê°€ ì•„ì´ë””ì™€ ë¹„ë°€ë²ˆí˜¸ë¡œ ë¡œê·¸ì¸ì„ í•œë‹¤.
2. ì„œë²„ ì¸¡ì—ì„œ í•´ë‹¹ ì •ë³´ë¥¼ ê²€ì¦í•œë‹¤.
3. ì •ë³´ê°€ ì •í™•í•˜ë‹¤ë©´ ì„œë²„ ì¸¡ì—ì„œ ì‚¬ìš©ìì—ê²Œ Signed í† í°ì„ ë°œê¸‰í•œë‹¤. (SignedëŠ” í•´ë‹¹ í† í°ì´ ì„œë²„ì—ì„œ ì •ìƒì ìœ¼ë¡œ ë°œê¸‰ëœ í† í°ì„ì„ ì¦ëª…í•˜ëŠ” Signatureë¥¼ ê°€ì§€ê³  ìˆë‹¤ëŠ” ê²ƒ)
4. í´ë¼ì´ì–¸íŠ¸ ì¸¡ì—ì„œ ì „ë‹¬ë°›ì€ í† í°ì„ ì €ì¥í•´ë‘ê³ , ì„œë²„ì— ìš”ì²­ì„ í•  ë•Œë§ˆë‹¤ í•´ë‹¹ í† í°ì„ ì„œë²„ì— í•¨ê»˜ ì „ë‹¬í•œë‹¤. ì´ë•Œ Http ìš”ì²­ í—¤ë”ì— í† í°ì„ í¬í•¨ì‹œí‚¨ë‹¤. 
ex)  axios.defaults.headers.common.Authorization = `Bearer ${token}`;
5. ì„œë²„ëŠ” í† í°ì„ ê²€ì¦í•˜ê³ , ìš”ì²­ì— ì‘ë‹µí•œë‹¤.
 ////////////
- ìœ ì €ê°€ ë¡œê·¸ì¸ì„ í•˜ê³  ì„œë²„ì— ì„¸ì…˜ì„ ì´ìš©í•´ì„œ ì •ë³´ë¥¼ ê¸°ë¡í•˜ëŠ”ëŒ€ì‹ , Token ì„ ë°œê¸‰í•œë‹¤.
 - í´ë¼ì´ì–¸íŠ¸ëŠ” ë°œê¸‰ëœ Token ì„ ì €ì¥í•œë‹¤ (ì¼ë°˜ì ìœ¼ë¡œ local storage ì— ì €ì¥í•œë‹¤.)
 - í´ë¼ì´ì–¸íŠ¸ëŠ” ìš”ì²­ ì‹œ ì €ì¥ëœ Token ì„ Header ì— í¬í•¨ì‹œì¼œ ë³´ë‚¸ë‹¤. 
 - ì„œë²„ëŠ” ë§¤ ìš”ì²­ì‹œ í´ë¼ì´ì–¸íŠ¸ë¡œë¶€í„° ì „ë‹¬ë°›ì€ Header ì˜ Token ì •ë³´ë¥¼ Verification í•œ ë’¤, í•´ë‹¹ ìœ ì €ì— ê¶Œí•œì„ ì¸ê°€í•œë‹¤.
ì¶œì²˜: https://jins-dev.tistory.com/entry/Session-ê¸°ë°˜-ì¸ì¦ê³¼-Token-ê¸°ë°˜-ì¸ì¦ [Jins' Dev Inside]
*/
```

### 11ì¼

1. í”„ë¡œì íŠ¸ ë§Œë“¤ê¸°
2. í”„ë¡œì íŠ¸ ë¦¬ìŠ¤íŠ¸ ì¶œë ¥ 

    ```jsx
    function loadProjectsAPI() {
      return axios.get('/projects');
    }

    function* loadProjects() {
      try {
        const result = yield call(loadProjectsAPI);
        console.log('resultresultresult', result.data);
        yield put({
          type: LOAD_PROJECTS_SUCCESS,
          data: result.data.projectList,
        });
      } catch (error) {
        console.log(error);
        yield put({
          type: LOAD_PROJECTS_FAILURE,
          error,
        });
      }
    }
    /////main.js
    export const getServerSideProps = wrapper.getServerSideProps(async (context) => {
      const { token } = cookies(context);
      const cookie = context.req ? context.req.headers.cookie : '';
      axios.defaults.headers.Cookie = '';
      if (context.req && cookie) {
        axios.defaults.headers.common.Authorization = `Bearer ${token}`;
      }
      context.store.dispatch({
        type: LOAD_PROJECTS_REQUEST,
      });
      context.store.dispatch(END);
      await context.store.sagaTask.toPromise();
    });
    /*
    ssr ì´ë¼ì„œ ìƒˆë¡œê³ ì¹¨?  ...  í˜ì´ì§€ ì´ë™ì‹œì— redux state ê°€ ì´ˆê¸°í™”ê°€ ëœë‹¤.
    ì„œë²„ì—ì„œ í˜ì´ì§€ë¥¼ ë¶ˆëŸ¬ ì˜¬ë•Œë§ˆë‹¤ getServerSideProps: ê°ê°ì˜ ìš”ì²­ë§ˆë‹¤ dataë¥¼ fetchí•œë‹¤.
    ìœ ì €ì¸ì¦ì„ ìœ„í•´ ì¿ í‚¤ì— ì €ì¥í•œ í† í°ì„ import cookies from 'next-cookies'; ë¼ì´ë¸Œë¥¼ ì‚¬ìš©í•˜ì—¬ ê°€ì ¸ì™€ì„œ 
    headear ì— ë‹´ì•„ 

    context.store.dispatch({
        type: LOAD_PROJECTS_REQUEST,
     });
    í•˜ì˜€ë‹¤ .

    */
    ```

í˜ì´ì§€ì—ì„œ asyncí˜¸ì¶œ ëœ í•¨ìˆ˜ ë¥¼ ë‚´ ë³´ë‚´ë©´ getServerSidePropsNext.jsëŠ”ì—ì„œ ë°˜í™˜ í•œ ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ ê° ìš”ì²­ì— ëŒ€í•´ì´ í˜ì´ì§€ë¥¼ ì‚¬ì „ ë Œë”ë§í•©ë‹ˆë‹¤ getServerSideProps.

getServerSidePropsëŠ” ì„œë²„ì—ì„œ ì‹¤í–‰ë©ë‹ˆë‹¤. ì„œë²„ì—ì„œ ë¦¬ë•ìŠ¤ ìŠ¤í† ì–´ê°€ ìƒˆë¡œ ìƒì„±ëœ í›„ ì‹¤í–‰ë˜ëŠ” ê²ƒì´ë¼ ê¸°ì¡´ í´ë¼ì´ì–¸íŠ¸ ìŠ¤í…Œì´íŠ¸ì— ì ‘ê·¼í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.